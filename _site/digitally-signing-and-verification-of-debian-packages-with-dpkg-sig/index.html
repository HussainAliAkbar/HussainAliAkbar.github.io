<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Digitally Signing and Verification of Debian packages with dpkg-sig - Hussain Ali Akbar</title>

  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Hussain Ali Akbar" property="og:site_name">
  
    <meta content="Digitally Signing and Verification of Debian packages with dpkg-sig" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="A comprehensive guide to signing and verifying debian packages" property="og:description">
  
  
    <meta content="http://hussainAliAkbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" property="og:url">
  
  
    <meta content="2018-04-11T16:44:00+05:00" property="article:published_time">
    <meta content="http://hussainAliAkbar.github.io/about/" property="article:author">
  
  
    <meta content="http://hussainAliAkbar.github.io/assets/img/hussain-ali-akbar.jpg" property="og:image">
  
  
    
  
  
    
    <meta content="deb" property="article:tag">
    
    <meta content="signing" property="article:tag">
    
    <meta content="verification" property="article:tag">
    
    <meta content="packages" property="article:tag">
    
  

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
  
    <meta name="twitter:title" content="Digitally Signing and Verification of Debian packages with dpkg-sig">
  
  
    <meta name="twitter:url" content="http://hussainAliAkbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/">
  
  
    <meta name="twitter:description" content="A comprehensive guide to signing and verifying debian packages">
  
  
    <meta name="twitter:image:src" content="http://hussainAliAkbar.github.io/assets/img/hussain-ali-akbar.jpg">
  

	<meta name="description" content="A comprehensive guide to signing and verifying debian packages">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-touch-icon-114x114.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Digitally Signing and Verification of Debian packages with dpkg-sig | Hussain Ali Akbar</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Digitally Signing and Verification of Debian packages with dpkg-sig" />
<meta name="author" content="Hussain Ali Akbar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A comprehensive guide to signing and verifying debian packages" />
<meta property="og:description" content="A comprehensive guide to signing and verifying debian packages" />
<link rel="canonical" href="http://hussainaliakbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" />
<meta property="og:url" content="http://hussainaliakbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" />
<meta property="og:site_name" content="Hussain Ali Akbar" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-11T16:44:00+05:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://hussainaliakbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/","headline":"Digitally Signing and Verification of Debian packages with dpkg-sig","dateModified":"2018-04-11T16:44:00+05:00","datePublished":"2018-04-11T16:44:00+05:00","author":{"@type":"Person","name":"Hussain Ali Akbar"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://hussainaliakbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/"},"description":"A comprehensive guide to signing and verifying debian packages","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"><img src="/assets/img/hussain-ali-akbar.jpg" alt="Hussain Ali Akbar"></a>
      </div>
      <div class="author-name">Hussain Ali Akbar</div>
      <p>I am a Software Developer at 10 Pearls focusing on server-side development. I am always keen on learning new items that help me grow professionally as a software Developer. I have this blog set up so that i can share some of the amazing stuff that i learn and which has little to no content on the internet.</p>
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Contact me</h3>
      <ul>
<!--         
          <li><a href="https://twitter.com/artemsheludko_" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
         -->
        
          <li><a href="https://facebook.com/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
        
        
          <li class="github"><a href="http://github.com/github.com/hussainAliAkbar" target="_blank"><i class="fa fa-github"></i></a></li>
        
        
          <li class="linkedin"><a href="https://in.linkedin.com/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
        
        
          <li class="email"><a href="mailto:hussain94aa@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
        
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2018 &copy; Hussain Ali Akbar</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <article class="article-page">
  <div class="page-content">
    
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">Digitally Signing and Verification of Debian packages with dpkg-sig</h1>
        <div class="page-date"><span>2018, Apr 11&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      <p>Security Standards such as Common Criteria make it a requirement for all the Debian packages and installers to be Digitally signed so that they can be verified by the users in order to achieve compliance. This can be done very easily with dpkg-sig - a tool for generating and verifying signatures of debian packages.</p>

<p>1 - First thing’s first, we will need a sample package that we can sign and then verify. For this purpose, i chose the <strong>aribas</strong> package which can be <a href="https://packages.debian.org/stable/math/aribas">downloaded</a> from the official debian repository.</p>

<p>2 - Once we have the package that we need to sign and verify, we will need to create <strong>GPG Keys</strong>. I already have an entire post on <a href="../generating-and-using-GPG-keys/">generating and using GPG Keys</a> so you can refer to that in case you need any help.</p>

<p>3 - The next step is to install the <strong>dpkg-sig</strong> utility. That can be downloaded from the apt repository.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get install dpkg-sig
</code></pre></div></div>
<p>4 - Next we will need the GPG ID of the key that we will be using to sign the package. This id can be found by listing the gpg keys.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hussain@LTP-DEV-HUSSAINAKB ~/Downloads $ gpg --list-keys
/home/hussain/.gnupg/pubring.gpg
--------------------------------
pub   2048R/E5124174 2018-04-10
uid                  Hussain Ali Akbar (test gpg key) &lt;foo@bar.com&gt;
sub   2048R/A7F42694 2018-04-10
</code></pre></div></div>

<p>Here, <strong>E5124174</strong> is the GPG ID.</p>

<p>5 - The package can now be signed.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dpkg-sig -k &lt;GPG ID&gt; --sign builder aribas_1.64-6_amd64.deb 
</code></pre></div></div>
<p>change the GPG ID with the ID of your GPG Key.</p>

<p>6 - Verify the signature just to ensure that the package has been signed successfully.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hussain@LTP-DEV-HUSSAINAKB ~/Downloads $ dpkg-sig --verify aribas_1.64-6_amd64.deb Processing aribas_1.64-6_amd64.deb...
GOODSIG _gpgbuilder B16265877A80C8FB40327C4A681EFD1DE5124174 1523440651
hussain@LTP-DEV-HUSSAINAKB ~/Downloads $ 
</code></pre></div></div>
<p>You should see <strong>GOODSIG</strong> in the output of the verify command. Here i have verified the signature on the same machine on which i signed it so i did not run into any issues. On other user machines, the GPG Keys will first need to be to be imported into the system and then the package’s signature can be verified. The export and import process of the GPG Keys is defined in the <a href="../generating-and-using-GPG-keys/">previous post</a> as well.</p>

<p>There is a bug in older versions of dpkg-sig where it fails to verify the signature of debian packages compressed with xz. When you try to verify such a package it will give you <strong>“BADSIG _gpgbuilder</strong> error. This bug has been reported <a href="https://bugs.launchpad.net/ubuntu/+source/dpkg-sig/+bug/1342938">here</a>. This will not cause any issues on newer Debian based OSes like Ubuntu 16.04 LTS or Linux Mint 18.3, however, if you download dpkg-sig utility from the apt repository on older OSes like Ubuntu 14.04 LTS, it will download the older version of dpkg-sig which can cause issues while verifying the package.</p>

<p>If you stuck with older dpkg-sig versions, you can get around this by simply downloading the newer package from <a href="http://ftp.us.debian.org/debian/pool/main/d/dpkg-sig/dpkg-sig_0.13.1+nmu4_all.deb">the official repository</a> and extract it like this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ar vx dpkg-sig_0.13.1+nmu4_all.deb
</code></pre></div></div>
<p>Next, extract the contents from the <strong>data.tar.xz</strong>.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tar -xvf data.tar.xz
</code></pre></div></div>
<p>You should now have a usr folder which will contain the executable script for dpkg-sig. You can use it just like any other script.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usr/bin/dpkg-sig --verify aribas_1.64-6_amd64.deb
</code></pre></div></div>
<p>This should give you the correct output! 
I hope this was helpful. In the next post, we’ll look at signing RPM packages!</p>

      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=Digitally Signing and Verification of Debian packages with dpkg-sig&url=http://hussainAliAkbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u=http://hussainAliAkbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url=http://hussainAliAkbar.github.io/digitally-signing-and-verification-of-debian-packages-with-dpkg-sig/" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          
            <a href="/tags#deb" class="tag">&#35; deb</a>
          
            <a href="/tags#signing" class="tag">&#35; signing</a>
          
            <a href="/tags#verification" class="tag">&#35; verification</a>
          
            <a href="/tags#packages" class="tag">&#35; packages</a>
          
        </div>
      </div>
      <section class="comment-area">
  <div class="comment-wrapper">
    
  </div>
</section> <!-- End Comment Area -->

    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->

</div>

  </div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>
</html>
